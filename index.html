<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tarihi Kırkpınar Arşivi | Genişletilmiş Ansiklopedi (TÜBİTAK Projesi)</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <style>
        /* --- TASARIM (CSS) --- */
        :root {
            --gold: #d4af37;
            --dark-gold: #aa8c2c;
            --black: #0f0f0f;
            --dark-gray: #1a1a1a;
            --light-gray: #e0e0e0;
            --text-color: #f5f5f5;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background-color: var(--black); color: var(--text-color); font-family: 'Roboto', sans-serif; overflow-x: hidden; }
        h1, h2, h3, .nav-logo { font-family: 'Cinzel', serif; }
        a { text-decoration: none; color: inherit; transition: 0.3s; }
        
        /* Navbar */
        .navbar {
            display: flex; justify-content: space-between; align-items: center; padding: 15px 40px;
            background: rgba(15, 15, 15, 0.95); position: fixed; width: 100%; top: 0; z-index: 1000;
            border-bottom: 2px solid var(--gold); backdrop-filter: blur(5px);
        }
        .nav-logo { font-size: 1.5rem; color: #fff; display: flex; align-items: center; gap: 10px; }
        .nav-logo span { color: var(--gold); }
        .nav-links a { margin-left: 20px; font-size: 0.9rem; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; }
        .nav-links a:hover { color: var(--gold); }

        /* Hero (Giriş) */
        .hero {
            height: 80vh; position: relative; display: flex; align-items: center; justify-content: center; text-align: center;
            /* Lütfen 'img/er_meydani.jpg' dosyasının yüklendiğinden emin olun */
            background: linear-gradient(rgba(0,0,0,0.7), var(--black)), url('img/er_meydani.jpg');
            background-size: cover; background-position: center;
            background-attachment: fixed;
        }
        .hero h1 { font-size: 3.5rem; color: var(--gold); margin-bottom: 10px; text-shadow: 0 0 20px #000; }
        .btn { padding: 12px 30px; border: 2px solid var(--gold); color: var(--gold); font-weight: bold; cursor: pointer; background: transparent; transition: 0.3s; margin-top: 20px; display: inline-block; }
        .btn:hover { background: var(--gold); color: #000; }

        .container { max-width: 1200px; margin: 0 auto; padding: 60px 20px; }
        .section-title { text-align: center; font-size: 2.5rem; margin-bottom: 40px; border-bottom: 1px solid #333; padding-bottom: 15px; }
        .gold { color: var(--gold); }

        /* Pehlivan Kartları */
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 25px; }
        .card { background: var(--dark-gray); border-radius: 8px; overflow: hidden; border: 1px solid #333; cursor: pointer; transition: 0.3s; position: relative; }
        .card:hover { transform: translateY(-5px); border-color: var(--gold); box-shadow: 0 5px 15px rgba(212,175,55,0.2); }
        .card-img { width: 100%; height: 300px; object-fit: cover; object-position: top center; background: #222; }
        .card-info { padding: 15px; text-align: center; }
        .card-badge { position: absolute; top: 10px; right: 10px; background: var(--gold); color: #000; padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; font-weight: bold; z-index: 2; }
        
        /* Tablo */
        .table-box { max-height: 500px; overflow-y: auto; background: var(--dark-gray); border: 1px solid #333; border-radius: 8px; }
        table { width: 100%; border-collapse: collapse; }
        th { background: #111; color: var(--gold); padding: 15px; text-align: left; position: sticky; top: 0; z-index: 10; border-bottom: 2px solid var(--gold); }
        td { padding: 12px 15px; border-bottom: 1px solid #333; color: #ddd; }
        tr:hover td { background: #252525; }

        /* Harita */
        #map { height: 500px; width: 100%; border-radius: 10px; border: 2px solid #333; }
        
        /* Popup & Modal */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 2000; justify-content: center; align-items: center; }
        .modal-content { background: var(--dark-gray); padding: 30px; width: 90%; max-width: 900px; height: 85vh; border-radius: 10px; border: 1px solid var(--gold); display: flex; gap: 30px; flex-wrap: wrap; align-items: flex-start; overflow-y: auto; }
        .modal-img { width: 300px; height: 400px; object-fit: cover; border-radius: 5px; border: 2px solid #333; box-shadow: 0 0 20px rgba(0,0,0,0.5); object-position: top; }
        .modal-text { flex: 1; min-width: 300px; }
        .close-btn { position: absolute; top: 20px; right: 30px; font-size: 40px; color: #fff; cursor: pointer; transition: 0.3s; z-index: 2001; }
        .close-btn:hover { color: var(--gold); }

        /* Modal İçindeki Analiz Sonucu */
        #aiAnalysisResult {
            margin-top: 20px;
            padding: 15px;
            background: rgba(212, 175, 55, 0.15);
            border-left: 4px solid var(--gold);
            border-radius: 5px;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* Kıyaslama Seçim Alanı */
        .compare-area { display: flex; justify-content: center; gap: 20px; margin-bottom: 30px; flex-wrap: wrap; }
        select { padding: 12px; background: #222; color: #fff; border: 1px solid #555; width: 220px; border-radius: 5px; }
        
        /* KIYASLAMA SONUÇ KARTLARI */
        .result-box { 
            display: none; 
            justify-content: center; 
            align-items: center;
            gap: 40px; 
            margin-top: 20px; 
            flex-wrap: wrap; 
            width: 100%;
            max-width: 1000px;
            margin-left: auto;
            margin-right: auto;
        }
        .res-card { 
            text-align: center; 
            background: #222; 
            padding: 30px;
            border-radius: 10px; 
            width: 350px; 
            border: 2px solid #444; 
            transition: 0.3s;
            box-shadow: 0 0 10px rgba(212, 175, 55, 0.2);
        }
        .res-card:hover {
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.4);
        }
        
        .res-card img { 
            width: 160px;
            height: 160px; 
            border-radius: 50%; 
            object-fit: cover; 
            margin-bottom: 10px; 
            border: 4px solid var(--gold);
            object-position: top; 
        }
        
        .comp-badge { 
            display: block; 
            padding: 8px 15px; 
            background: var(--dark-gold); 
            color: #000; 
            font-weight: bold; 
            border-radius: 5px; 
            margin-bottom: 20px; 
            font-size: 1rem;
        }
        
        .stats-group { 
            text-align: left; 
            margin-top: 20px;
            padding-top: 15px;
            border-top: 2px dashed #333;
        }
        
        .stat-line { 
            display: flex; 
            justify-content: space-between; 
            padding: 12px 0;
            border-bottom: 1px solid #333; 
            font-size: 1.1rem; 
        }
        .stat-line:last-child { border-bottom: none; }

        .stat-bmi {
            font-weight: bold;
            color: var(--light-gray);
            font-size: 1.2rem;
            background: rgba(212, 175, 55, 0.1);
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            text-align: center;
        }
        
        /* Kariyer Detay Vurgusu */
        .career-detail {
            margin-top: 15px;
            padding: 10px 0;
            color: #ccc;
            font-size: 0.95rem;
            font-style: italic;
            border-top: 1px solid #333;
        }
        .career-detail strong {
            color: var(--gold);
            display: block;
            margin-bottom: 5px;
        }

        /* VS Simge Stili */
        .vs-badge-large {
            font-family: 'Cinzel', serif;
            font-size: 2.5rem;
            color: var(--gold);
            font-weight: 700;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin: 0 20px;
            z-index: 10;
        }
        .vs-badge-large i { 
            font-size: 3rem;
            margin-bottom: 10px; 
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);
        }

        /* Kazanan/Üstünlük Vurgusu */
        .winner { 
            color: #2ecc71; 
            font-weight: bold; 
            animation: pulse-green 1s infinite alternate; 
        }
        @keyframes pulse-green {
            from { text-shadow: 0 0 2px rgba(46, 204, 113, 0.5); }
            to { text-shadow: 0 0 6px rgba(46, 204, 113, 1); }
        }
        
        /* ANALİZ BÖLÜMÜNÜN YENİ LAYOUT'U */
        /* Kıyaslama ve grafiklerin alt alta gelmesini sağlayan yapı */
        #analiz > div {
            flex-direction: column; 
            gap: 60px; 
        }
        
        /* KIYASLAMA VE GRAFİK BÖLÜMLERİ ARTIK TAM GENİŞLİKTE OLACAK */
        #analiz .kıyaslama-wrapper {
            flex: none; 
            width: 100%; 
            min-width: unset;
        }
        #analiz .grafik-wrapper {
            flex: none;
            width: 100%; 
            min-width: unset;
        }

        /* --- FİZİKSEL ANALİZ (YENİ TABLO STİLİ) --- */
        .physical-analysis-box {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            width: 100%; /* Tüm alanı kullan */
            justify-content: center;
        }
        
        /* TEK GRAFİK İÇİN TAM ALAN */
        .chart-container-single {
            width: 100%; 
            background: #222;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #333;
            /* Yüksekliği artırdıkça yatay eksen daha rahatlar */
            height: 600px; 
        }
        
        /* Grafik Canvas'ı için sabit genişlik ayarı kaldırıldı, responsive kullanacak */
        #combinedChartCanvas {
            width: 100% !important;
            height: 100% !important;
        }


        /* --- YENİ: CHATBOT STİLLERİ --- */
        .chat-btn { position: fixed; bottom: 30px; right: 30px; background: var(--gold); color: #000; width: 60px; height: 60px; border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 24px; cursor: pointer; box-shadow: 0 5px 15px rgba(212,175,55,0.4); z-index: 1000; transition: transform 0.3s; }
        .chat-btn:hover { transform: scale(1.1); }
        .chat-box { 
            display: none; 
            flex-direction: column; 
            position: fixed; 
            bottom: 100px; 
            right: 30px; 
            width: 350px; 
            height: 450px; 
            background: #1a1a1a; 
            border: 2px solid var(--gold); 
            border-radius: 10px; 
            z-index: 1001; 
            overflow: hidden; 
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }
        .chat-header { background: var(--gold); color: #000; padding: 12px; font-weight: bold; display: flex; justify-content: space-between; align-items: center; }
        .chat-close { cursor: pointer; font-size: 1.5rem; }
        .chat-messages { flex: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .message { max-width: 85%; padding: 10px; border-radius: 10px; font-size: 0.9rem; line-height: 1.4; }
        .bot-msg { background: #333; color: #ddd; align-self: flex-start; border-bottom-left-radius: 0; }
        .user-msg { background: var(--dark-gold); color: #111; align-self: flex-end; border-bottom-right-radius: 0; font-weight: 500; }
        .chat-input-area { padding: 10px; background: #111; display: flex; border-top: 1px solid #333; }
        .chat-input { flex: 1; padding: 10px; background: #222; border: none; color: #fff; border-radius: 5px; outline: none; }
        .chat-send { background: transparent; border: none; color: var(--gold); margin-left: 10px; cursor: pointer; font-weight: bold; font-size: 1.2rem; }


        /* Footer */
        footer { text-align: center; padding: 30px; background: #000; border-top: 1px solid #222; color: #777; margin-top: 50px; }

        @media (max-width: 1024px) {
            .chart-container-half {
                min-width: 100%; /* Tablette tam genişlik */
                height: 350px;
            }
            .kıyaslama-wrapper {
                flex: 1;
                min-width: 100%;
            }
            .grafik-wrapper {
                flex: 1;
                min-width: 100%;
            }
        }

        @media (max-width: 768px) {
            .navbar { flex-direction: column; padding: 10px; }
            .nav-links { margin-top: 10px; display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }
            .modal-content { flex-direction: column; align-items: center; text-align: center; height: auto; max-height: 90vh; }
            .hero h1 { font-size: 2.5rem; }
            .compare-area { flex-direction: column; align-items: center; }
            .result-box { flex-direction: column; gap: 20px; }
            .vs-badge-large { margin: 10px 0; }
            
            /* Mobil için kiyaslama ve grafiği alt alta al */
            #analiz > div {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>

    <nav class="navbar">
        <div class="nav-logo"><i class="fas fa-medal"></i> KIRKPINAR <span>ARŞİVİ</span></div>
        <div class="nav-links">
            <a href="#tarihce">Tarihçe</a>
            <a href="#pehlivanlar">Pehlivanlar</a>
            <a href="#harita">Edirne Haritası</a>
            <a href="#analiz">Analiz</a>
        </div>
    </nav>

    <header class="hero">
        <div>
            <h1>ER MEYDANI</h1>
            <p style="font-size: 1.3rem; margin-bottom: 20px; max-width: 800px; margin-left: auto; margin-right: auto;">
                Tarihi Kırkpınar Yağlı Güreşleri Dijital Ansiklopedisi
            </p>
            <p style="font-size: 1rem; color: #ccc;">Geçmişten Günümüze Efsaneler ve Şampiyonlar</p>
            <a href="#pehlivanlar" class="btn">Pehlivanları Keşfet</a>
        </div>
    </header>

    <section id="pehlivanlar" class="container">
        <h2 class="section-title">PEHLİVANLAR <span class="gold">GEÇİDİ</span></h2>
        
        <div style="text-align:center; margin-bottom: 40px;">
            <div style="position: relative; max-width: 400px; margin: 0 auto;">
                <input type="text" id="searchInput" placeholder="Pehlivan Adı Ara..." onkeyup="filtrele()" 
                style="padding:15px; width: 100%; border-radius:30px; background:#222; border:1px solid #444; color:#fff; text-align:center; outline: none; font-size: 1rem;">
                <i class="fas fa-search" style="position: absolute; right: 20px; top: 18px; color: #666;"></i>
            </div>
            <div style="margin-top: 15px;">
                <button onclick="kategoriFiltre('Tümü')" class="btn" style="padding: 5px 15px; font-size: 0.8rem; margin: 5px;">Tümü</button>
                <button onclick="kategoriFiltre('Efsane')" class="btn" style="padding: 5 fpx 15px; font-size: 0.8rem; margin: 5px;">Efsaneler</button>
                <button onclick="kategoriFiltre('Aktif')" class="btn" style="padding: 5 fpx 15px; font-size: 0.8rem; margin: 5px;">Aktif</button>
            </div>
        </div>

        <div class="grid" id="pehlivanGrid">
            </div>
        <p id="noResult" style="text-align: center; display: none; color: #aaa; margin-top: 20px;">Aradığınız kriterde pehlivan bulunamadı.</p>
    </section>

    <section id="tarihce" class="container">
        <h2 class="section-title">GÜNÜMÜZDEN GEÇMİŞE <span class="gold">ŞAMPİYONLAR</span></h2>
        <div class="table-box">
            <table id="tarihceTable">
                <thead>
                    <tr>
                        <th width="100">Yıl</th>
                        <th>Başpehlivan</th>
                        <th>Şehir (Memleket)</th>
                        <th>Notlar</th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
        </div>
    </section>

    <section id="harita" class="container">
        <h2 class="section-title">PEHLİVANLARIN <span class="gold">MEMLEKET HARİTASI</span></h2>
        <p style="text-align:center; margin-bottom:20px; color:#aaa;">Harita üzerindeki işaretlere tıklayarak pehlivanların memleketlerini görebilirsiniz.</p>
        <div id="map"></div>
    </section>

    <section id="analiz" class="container">
        <div style="display: flex; flex-wrap: wrap; gap: 40px;">
            
            <div class="kıyaslama-wrapper" style="width: 100%;">
                <h3 style="color:var(--gold); margin-bottom: 20px; text-align:center; border-bottom: 1px solid #333; padding-bottom: 10px;">Birebir Kıyaslama</h3>
                <div class="compare-area">
                    <select id="sel1" onchange="kiyasla()"><option value="" disabled selected>1. Pehlivan</option></select>
                    <span style="font-size:1.5rem; font-weight:bold; padding-top:5px; color:#666;">VS</span>
                    <select id="sel2" onchange="kiyasla()"><option value="" disabled selected>2. Pehlivan</option></select>
                </div>
                
                <div id="compResult" class="result-box">
                    <div class="res-card res-card-1">
                        <img id="cImg1" src="" onerror="imgError(this)">
                        <h4 id="cName1" class="gold"></h4>
                        <span id="cTur1" class="comp-badge"></span>
                        <div class="stats-group">
                            <div class="stat-line"><span><i class="fas fa-ruler-vertical"></i> Boy (cm):</span> <b id="cBoy1"></b></div>
                            <div class="stat-line"><span><i class="fas fa-weight-hanging"></i> Kilo (kg):</span> <b id="cKilo1"></b></div>
                            <div class="stat-line"><span><i class="fas fa-hammer"></i> Uzmanlık:</span> <b id="cUzmanlik1" style="font-size:0.9rem;"></b></div> <div class="stat-line stat-bmi"><span><i class="fas fa-calculator"></i> Vücut Kitle İndeksi (BMI):</span> <b id="cBMI1"></b></div>
                        </div>
                            <div class="career-detail">
                            <strong>Öne Çıkan Kariyer Özellikleri:</strong> 
                            <span id="cCareer1"></span>
                        </div>
                    </div>
                    
                    <div class="vs-badge-large">
                        <i class="fas fa-times-circle"></i> VS
                    </div>

                    <div class="res-card res-card-2">
                        <img id="cImg2" src="" onerror="imgError(this)">
                        <h4 id="cName2" class="gold"></h4>
                        <span id="cTur2" class="comp-badge"></span>
                        <div class="stats-group">
                            <div class="stat-line"><span><i class="fas fa-ruler-vertical"></i> Boy (cm):</span> <b id="cBoy2"></b></div>
                            <div class="stat-line"><span><i class="fas fa-weight-hanging"></i> Kilo (kg):</span> <b id="cKilo2"></b></div>
                            <div class="stat-line"><span><i class="fas fa-hammer"></i> Uzmanlık:</span> <b id="cUzmanlik2" style="font-size:0.9rem;"></b></div> <div class="stat-line stat-bmi"><span><i class="fas fa-calculator"></i> Vücut Kitle İndeksi (BMI):</span> <b id="cBMI2"></b></div>
                        </div>
                        <div class="career-detail">
                            <strong>Öne Çıkan Kariyer Özellikleri:</strong> 
                            <span id="cCareer2"></span>
                        </div>
                    </div>
                </div>
                
                <div id="aiSimulationArea" style="display:none; text-align:center; margin-top:40px;">
                        <button class="btn" onclick="simulateMatch()" style="background:var(--gold); color:#000;">
                         <i class="fas fa-microchip"></i> ✨ AI Maç Senaryosu Oluştur
                        </button>
                        <div id="aiSimulationResult" style="margin-top:20px; padding:20px; background:rgba(212, 175, 55, 0.1); border-left: 3px solid var(--gold); border-radius: 5px; text-align: left; line-height: 1.6; font-style: italic;">
                            </div>
                </div>
            </div>

            <div class="grafik-wrapper chart-and-list-area" style="width: 100%;">
                <h3 style="color:var(--gold); margin-bottom: 20px; text-align:center; border-bottom: 1px solid #333; padding-bottom: 10px;">Fiziksel Analiz (Tüm Pehlivanlar)</h3>
                <div class="physical-analysis-box">
                    
                    <div class="chart-container-single">
                        <h4 style="color:#aaa; text-align:center; margin-bottom: 10px;">Boy (cm) ve Kilo (kg) Karşılaştırması</h4>
                        <canvas id="combinedChartCanvas"></canvas>
                    </div>
                    
                </div>
            </div>
        </div>
    </section>

    <div id="bioModal" class="modal">
        <div class="modal-content" style="position:relative;">
            <span class="close-btn" onclick="document.getElementById('bioModal').style.display='none'">&times;</span>
            <img id="mImg" class="modal-img" src="" onerror="imgError(this)">
            <div class="modal-text">
                <div style="border-bottom: 1px solid #333; padding-bottom: 15px; margin-bottom: 15px;">
                    <h2 id="mName" class="gold" style="font-size: 2rem; margin-bottom:5px;"></h2>
                    <h4 id="mLakap" style="color:#aaa; font-style:italic; font-weight: normal;"></h4>
                </div>
                
                <div style="display:flex; gap:30px; margin-bottom:20px; font-weight:bold; font-size: 1.1rem;">
                    <span><i class="fas fa-ruler-vertical" style="color:var(--gold)"></i> <span id="mBoy"></span> cm</span>
                    <span><i class="fas fa-weight-hanging" style="color:var(--gold)"></i> <span id="mKilo"></span> kg</span>
                    <span id="mTurBadge" style="background: #333; padding: 2px 10px; border-radius: 4px; font-size: 0.9rem; align-self: center;"></span>
                </div>
                
                <h4 style="color:var(--gold); margin-bottom: 10px;">Biyografi ve Kariyer</h4>
                <p id="mBio" style="line-height:1.8; color:ddd; font-size: 1rem; text-align: justify;"></p>
                
                <div class="career-detail" style="margin-top:10px;">
                    <strong><i class="fas fa-hand-rock"></i> Teknik Uzmanlık Alanı:</strong> 
                    <span id="mUzmanlik"></span> 
                </div>

                <button class="btn" onclick="analyzeForm(currentPehlivanId)" style="padding: 8px 15px; margin-top: 20px; background: #555; border-color: #555;">
                   <i class="fas fa-brain"></i> ✨ AI Form Analizi Başlat
                </button>
                <div id="aiFormAnalysisResult" style="margin-top:15px; padding:10px; background:rgba(255, 255, 255, 0.05); border-left: 3px solid #777; border-radius: 5px; font-size: 0.85rem; line-height: 1.4;">
                </div>

            </div>
        </div>
    </div>
    
    <div class="chat-btn" onclick="toggleChat()"><i class="fas fa-comments"></i></div>
    <div class="chat-box" id="chatBox">
        <div class="chat-header">
            <span><i class="fas fa-robot"></i> Kırkpınar Asistanı (AI)</span>
            <span class="chat-close" onclick="toggleChat()">&times;</span>
        </div>
        <div class="chat-messages" id="chatMessages">
            <div class="message bot-msg">Merhaba! Ben Kırkpınar Asistanıyım. Pehlivanlar, kurallar veya tarihi oyunlar hakkında dilediğinizi sorabilirsiniz.</div>
        </div>
        
        <div style="padding: 10px 15px; background: #222; border-top: 1px solid #333; font-size: 0.9rem;">
            <label for="personaSelect" style="color:var(--gold); margin-right: 10px;"><i class="fas fa-mask"></i> Persona:</label>
            <select id="personaSelect" style="background: #444; color: #fff; border: none; padding: 5px; border-radius: 4px;">
                <option value="assistant">Asistan (Bilge)</option>
                <option value="kocayusuf">Koca Yusuf (Efsane)</option>
            </select>
        </div>

        <div class="chat-input-area">
            <input type="text" id="chatInput" class="chat-input" placeholder="Bir soru yazın..." onkeypress="handleEnter(event)">
            <button class="chat-send" onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>


    <footer>
        <p>2025 TÜBİTAK Ortaöğretim Araştırma Projeleri Yarışması</p>
        <p style="font-size:0.8rem; margin-top:5px;">Veriler Tarihi Kırkpınar arşivlerinden derlenmiştir.</p>
    </footer>

    <script>
        // --- GEMINI API KEY BURAYA GELMELİ ---
        // BAĞLANTI HATASI ÇÖZÜMÜ İÇİN GÜNCELLENMİŞ ANAHTARINIZ:
        const apiKey = "AIzaSyD0KEm2psAlNcohg5VWYOdxcffVLc3-mEI"; 
        let currentPehlivanId = null;
        let combinedChart; // Grafik referansını globalde tutmak için

        // Yeni Alan: memleket (Harita için eklendi)
        const PEHLIVANLAR = [
            // --- AKTİF BAŞPEHLİVANLAR ---
            { 
                id: 1, 
                ad: "Yusuf Can Zeybek", 
                lakap: "Aslan", 
                boy: 185, 
                kilo: 110, 
                tur: "Aktif", 
                img: "img/yusuf_can_zeybek.jpg", 
                kariyer: "2023, 2024 Başpehlivan",
                dogumYili: 1993, 
                uzmanlik: "Çeviklik, Sürpriz Oyunlar, Tırpan ve Sırta Alma", 
                memleket: "Antalya", // YENİ ALAN
                bio: "Antalya Kaş doğumlu Yusuf Can Zeybek, güreş dünyasına çok hızlı bir giriş yapmıştır. 2021 yılında başaltı boyunda şampiyon olarak başpehlivanlığa yükselmiştir. Kısa boyuna rağmen inanılmaz çevikliği ve sürpriz oyunlarıyla rakiplerini şaşırtır. Özellikle 2023 yılında favori gösterilmemesine rağmen İsmail Balaban'ı finalde yenerek ilk altın kemerini takmış, bu başarısını tesadüf olmadığını kanıtlarcasına 2024 yılında da kemeri alarak üst üste iki kez şampiyon olmuştur. Antalya Büyükşehir Belediyesi ASAT Spor Kulübü adına güreşmektedir." 
            },
            { 
                id: 2, 
                ad: "Ali Gürbüz", 
                lakap: "Megastar", 
                boy: 197, 
                kilo: 125, 
                tur: "Aktif", 
                img: "img/ali_gurbuz.jpg", 
                kariyer: "4 Kez Başpehlivan (2011, 12, 19, 21)",
                dogumYili: 1988, 
                uzmanlik: "Uzun Boy Avantajı, Künde ve Tırpan",
                memleket: "Antalya", // YENİ ALAN
                bio: "Kırkpınar'ın eski başpehlivanlarından merhum Recep Gürbüz'ün oğludur. Babasının 1988'de kazandığı ama ömrü yetmediği için doyamadığı kemerin peşinden giderek güreşe başlamıştır. 1.97 metrelik boyu ve muazzam fiziğiyle 'Megastar' lakabını almıştır. En büyük özelliği, uzun boyunu avantaja çevirerek yaptığı 'künde' ve 'tırpan' oyunlarıdır. Ebedi kemer yolunda talihsizlikler yaşasa da modern dönemin en dominant güreşçisidir." 
            },
            { 
                id: 3, 
                ad: "İsmail Balaban", 
                lakap: "Sarı Fırtına", 
                boy: 180, 
                kilo: 98, 
                tur: "Aktif", 
                img: "img/ismail_balaban.jpg", 
                kariyer: "2 Kez Başpehlivan (2013, 2017)",
                dogumYili: 1987, 
                uzmanlik: "Yüksek Kondisyon, Paça Kazık ve İç Kazık",
                memleket: "Antalya", // YENİ ALAN
                bio: "Antalya Elmalı'nın Akçay köyünde, ikizi Turan Balaban ile birlikte güreşe başlamıştır. Yağlı güreş standartlarına göre kısa boylu ve hafif olmasına rağmen, inanılmaz kondisyonu ve hızı sayesinde 'Sarı Fırtına' lakabını almıştır. En meşhur oyunu 'paça kazık'tır; rakiplerinin altına girerek onları dengesiz yakalar. 2013 ve 2017 yıllarında Kırkpınar Başpehlivanı olmuştur. Güreşirken asla yorulmamasıyla bilinir." 
            },
            { 
                id: 4, 
                ad: "Orhan Okulu", 
                lakap: "Geri Vitesi Olmayan Pehlivan", 
                boy: 178, 
                kilo: 103, 
                tur: "Aktif", 
                img: "img/orhan_okulu.jpg", 
                kariyer: "2 Kez Başpehlivan (2015, 2018)",
                dogumYili: 1989, 
                uzmanlik: "Agresif Stil, Sürekli Baskı ve Sürat",
                memleket: "Antalya", // YENİ ALAN
                bio: "Antalya Kumluca doğumludur. Güreş stili tamamen agresiflik ve baskı üzerine kuruludur. Maç başladığı andan itibaren rakibine nefes aldırmadan saldırdığı için kendisine 'Geri Vitesi Olmayan Pehlivan' denilmiştir. 2015 ve 2018 yıllarında Kırkpınar Başpehlivanı olmuştur. Özellikle sıcak havalarda rakipleri yorulurken onun temposunu artırması en belirgin özelliğidir." 
            },
            { 
                id: 5, 
                ad: "Recep Kara", 
                lakap: "Usta", 
                boy: 188, 
                kilo: 115, 
                tur: "Aktif", 
                img: "img/recep_kara.jpg", 
                kariyer: "4 Kez Başpehlivan (2004, 07, 08, 16)",
                dogumYili: 1982, 
                uzmanlik: "Çangal, İç Kazık ve Teknik Hakimiyet",
                memleket: "Ordu", // YENİ ALAN
                bio: "Ordulu olan Recep Kara, 2000'li yılların en teknik ve en istikrarlı güreşçilerinden biridir. 4 kez başpehlivan olarak altın kemeri kazanmıştır. Çangal ve iç kazık oyunlarını çok iyi uygular. Ahmet Taşçı döneminden sonra gelen kuşağın en önemli temsilcisidir." 
            },
            { 
                id: 6, 
                ad: "Mehmet Yeşil Yeşil", 
                lakap: "Toros Kaplanı", 
                boy: 188, 
                kilo: 115, 
                tur: "Aktif", 
                img: "img/mehmet_yesil_yesil.jpg", 
                kariyer: "2 Kez Başpehlivan (2009, 2010)",
                dogumYili: 1987, 
                uzmanlik: "Minder Güreşi Kökeni, Centilmenlik, Yüksek Ayak Oyunları",
                memleket: "Antalya", // YENİ ALAN
                bio: "Antalya Aksu doğumludur. Aslen minder güreşi kökenli olup Avrupa şampiyonlukları bulunmaktadır. 2009 ve 2010 yıllarında üst üste şampiyon olarak büyük bir sükse yapmıştır. Güreş camiasında beyefendiliği, sakinliği ve rakiplerine olan saygısıyla 'Örnek Sporcu' olarak gösterilir." 
            },
            { 
                id: 7, 
                ad: "Fatih Atlı", 
                lakap: "Ladikli", 
                boy: 183, 
                kilo: 108, 
                tur: "Aktif", 
                img: "img/fatih_atli.jpg", 
                kariyer: "1 Kez Başpehlivan (2014)",
                dogumYili: 1982, 
                uzmanlik: "Sürat, Patlayıcı Güç ve Karadeniz Ekolü",
                memleket: "Samsun", // YENİ ALAN
                bio: "Samsun'un Ladik ilçesindendir. Karadeniz güreş ekolünün en önemli temsilcilerinden biridir. Çok süratli ve patlayıcı gücü yüksek bir güreşçidir. 2014 yılında, o dönemin favorisi İsmail Balaban'ı finalde yenerek başpehlivan olmuştur. Rakiplerinin bir anlık dalgınlığını affetmez." 
            },
            { 
                id: 8, 
                ad: "Mustafa Taş", 
                lakap: "Sinoplu", 
                boy: 187, 
                kilo: 110, 
                tur: "Aktif", 
                img: "img/mustafa_tas.jpg", 
                kariyer: "1 Kez Başpehlivan (2022)",
                dogumYili: 1990, 
                uzmanlik: "Güçlü Fizik, Sert Hamleler ve Geriye Pasif Oynama",
                memleket: "Sinop", // YENİ ALAN
                bio: "Sinop Boyabatlıdır. Çok güçlü bir fiziğe ve kollara sahiptir. 2022 Kırkpınar güreşlerinde kemeri alarak tarihe geçmiştir. Henüz genç yaşına rağmen baş boyunda istikrarlı bir grafik çizmektedir." 
            },
            { 
                id: 9, 
                ad: "Osman Aynur", 
                lakap: "Antalyalı", 
                boy: 182, 
                kilo: 105, 
                tur: "Aktif", 
                img: "img/osman_aynur.jpg", 
                kariyer: "1 Kez Başpehlivan (2006)",
                dogumYili: 1980, 
                uzmanlik: "Sert ve Mücadeleci Güreş, Bel Kündesi",
                memleket: "Antalya", // YENİ ALAN
                bio: "2006 yılı Kırkpınar Başpehlivanıdır. Recep Kara'yı finalde yenerek altın kemere uzanmıştır. Antalya'nın yağlı güreşteki yükseliş döneminin (2000 sonrası) ilk büyük şampiyonlarından biridir. Sert ve mücadeleci güreşiyle tanınır." 
            },
            { 
                id: 10, 
                ad: "Şaban Yılmaz", 
                lakap: "Samsunlu", 
                boy: 185, 
                kilo: 115, 
                tur: "Aktif", 
                img: "img/saban_yilmaz.jpg", 
                kariyer: "1 Kez Başpehlivan (2005)",
                dogumYili: 1981, 
                uzmanlik: "El Ense Çekme, Tecrübe ve Kurt Güreşi",
                memleket: "Samsun", // YENİ ALAN
                bio: "2005 yılı Kırkpınar Başpehlivanıdır. 'El Ense' çekmesiyle meşhurdur, rakiplerini bu sert hamleleriyle yorar ve bozar. Er meydanının en tecrübeli ve 'kurt' güreşçilerinden biridir." 
            },
            { 
                id: 11, 
                ad: "İsmail Koç", 
                lakap: "Trakya Gladyatörü", 
                boy: 195, 
                kilo: 135, 
                tur: "Aktif", 
                img: "img/ismail_koc.jpg", 
                kariyer: "2021 İkincisi (Finalist)",
                dogumYili: 1991, 
                uzmanlik: "Devasa Cüsse, Kuvvetli Bağlama ve Uzun Süreli Baskı",
                memleket: "Edirne", // YENİ ALAN
                bio: "Edirne Trakya Birlik formasıyla güreşen, bölgenin en büyük umutlarından biridir. Ali Gürbüz ile benzer fiziksel özelliklere sahip, devasa bir cüsseye sahiptir. 2021 yılında final oynamış ancak ikincilikte kalmıştır. Trakya halkının çok sevdiği, tribünlerin desteğini arkasına alan güçlü bir başpehlivandır." 
            },

            // --- EFSANE BAŞPEHLİVANLAR ---
            { 
                id: 12, 
                ad: "Ahmet Taşçı", 
                lakap: "Karamürselli", 
                boy: 184, 
                kilo: 105, 
                tur: "Efsane", 
                img: "img/ahmet_tasci.jpg", 
                kariyer: "9 Kez Başpehlivan (2 Ebedi Kemer)",
                dogumYili: 1958, 
                uzmanlik: "Akılcı Güreş, Sırta Alma ve Sağlam Duruş",
                memleket: "Kocaeli", // YENİ ALAN
                bio: "Cumhuriyet tarihinin en büyük efsanelerinden biridir. 1990-2000 yılları arasına damga vurmuştur. İki kez altın kemerin ebedi sahibi olmuştur. Gücü, zekası ve karizmasıyla 'Yaşayan Efsane' olarak anılır." 
            },
            { 
                id: 13, 
                ad: "Koca Yusuf", 
                lakap: "Cihan Pehlivanı", 
                boy: 188, 
                kilo: 145, 
                tur: "Efsane", 
                img: "img/koca_yusuf.jpg", 
                kariyer: "1885 Başpehlivanı (Dünya Şampiyonu)",
                dogumYili: 1857, 
                uzmanlik: "Olağanüstü Güç, Yabancı Güreşlerde Serbest Stil",
                memleket: "Şumnu, Bulgaristan", // YENİ ALAN
                bio: "1857-1898 yılları arasında yaşamış, Deliorman kökenli efsanevi güreşçidir. Avrupa ve Amerika'ya giderek oradaki tüm güreşçileri yenmiş, 'The Terrible Turk' (Korkunç Türk) lakabını almıştır. Muazzam bir güce sahipti." 
            },
            { 
                id: 14, 
                ad: "Kel Aliço", 
                lakap: "Gaddar", 
                boy: 190, 
                kilo: 135, 
                tur: "Efsane", 
                img: "img/kel_alico.jpg", 
                kariyer: "27 Yıl Kesintisiz Başpehlivan",
                dogumYili: 1844, 
                uzmanlik: "Acımasızlık, Sert Bağlama ve Çengel Atma",
                memleket: "Plevne, Bulgaristan", // YENİ ALAN
                bio: "Kırkpınar tarihinde kırılması imkansız bir rekorun sahibidir: Tam 27 yıl boyunca başpehlivan olmuştur. Rakiplerine karşı acımasız ve çok sert güreştiği için 'Gaddar' lakabını almıştır. Koca Yusuf'un ve Adalı Halil'in ustasıdır." 
            },
            { 
                id: 15, 
                ad: "Kurtdereli Mehmet", 
                lakap: "Cihan Şampiyonu", 
                boy: 188, 
                kilo: 128, 
                tur: "Efsane", 
                img: "img/kurtdereli_mehmet.jpg", 
                kariyer: "Atatürk'ün Övdüğü Şampiyon",
                dogumYili: 1864, 
                uzmanlik: "Teknik Oyunlar ve Taktiksel Zeka",
                memleket: "Balıkesir", // YENİ ALAN
                bio: "Balıkesir Kurtdere köyündendir. Koca Yusuf ile Avrupa turnelerine çıkmış ve büyük başarılar kazanmıştır. Mustafa Kemal Atatürk, Kurtdereli'ye hayranlık duymuş ve ona bir mektup ile ödül göndermiştir." 
            },
            { 
                id: 16, 
                ad: "Adalı Halil", 
                lakap: "Pehlivan-ı Zaman", 
                boy: 198, 
                kilo: 130, 
                tur: "Efsane", 
                img: "img/adali_halil.jpg", 
                kariyer: "18 Yıl Başpehlivan",
                dogumYili: 1871, 
                uzmanlik: "Uzun Kol Avantajı, Bel Kündesi ve Çangal",
                memleket: "Edirne", // YENİ ALAN
                bio: "Yaklaşık 1.98 boyuyla döneminin en iri pehlivanlarındandır. Kel Aliço'nun çırağıdır ve ustasını yenen nadir kişilerdendir. 18 yıl boyunca başpehlivanlık yapmıştır." 
            },
            { 
                id: 17, 
                ad: "Hergeleci İbrahim", 
                lakap: "Hergeleci", 
                boy: 185, 
                kilo: 110, 
                tur: "Efsane", 
                img: "img/hergeleci_ibrahim.jpg", 
                kariyer: "Koca Yusuf ile Yenişemedi",
                dogumYili: 1848, 
                uzmanlik: "Mükemmel Teknik Bilgi, Kaba Güce Karşı Oyun",
                memleket: "Kocaeli", // YENİ ALAN
                bio: "Koca Yusuf ile saatlerce güreşip yenişememesiyle ünlüdür. Çok teknik bir güreşçidir, kaba kuvvetten ziyade oyun bilgisiyle kazanır. Lakabı gençliğinde hırçın atları (hergele) ehlileştirmesinden gelmektedir." 
            },
            { 
                id: 18, 
                ad: "Tekirdağlı Hüseyin", 
                lakap: "Alkış", 
                boy: 186, 
                kilo: 115, 
                tur: "Efsane", 
                img: "img/tekirdagli_huseyin.jpg", 
                kariyer: "8 Yıl Kesintisiz Şampiyon",
                dogumYili: 1898, 
                uzmanlik: "Centilmen Güreş Stili ve Yüksek Dayanıklılık",
                memleket: "Tekirdağ", // YENİ ALAN
                bio: "Cumhuriyet döneminin ilk büyük başpehlivanlarındandır. 1935-1942 yılları arasında tam 8 yıl üst üste Kırkpınar başpehlivanı olarak efsaneleşmiştir. Çok centilmen olduğu için 'Alkış' soyadını almıştır." 
            },
            { 
                id: 19, 
                ad: "Aydın Demir", 
                lakap: "Karamürselli", 
                boy: 184, 
                kilo: 110, 
                tur: "Efsane", 
                img: "img/aydin_demir.jpg", 
                kariyer: "1 Ebedi Altın Kemer (1976-78)",
                dogumYili: 1950, 
                uzmanlik: "Çok Yönlü Oyunlar ve Çeviklik",
                memleket: "Kocaeli", // YENİ ALAN
                bio: "1976, 1977 ve 1978 yıllarında üst üste üç kez başpehlivan olarak altın kemerin ebedi sahibi olmuştur. Ahmet Taşçı'nın da ustasıdır ve onu güreşe başlatan kişidir." 
            },
            { 
                id: 20, 
                ad: "Mustafa Bük", 
                lakap: "Ordulu", 
                boy: 183, 
                kilo: 105, 
                tur: "Efsane", 
                img: "img/mustafa_buk.jpg", 
                kariyer: "1 Ebedi Altın Kemer (1966-68)",
                dogumYili: 1937, 
                uzmanlik: "Karadeniz Oyunları, Kısa Boya Rağmen Kuvvet",
                memleket: "Ordu", // YENİ ALAN
                bio: "Karadeniz'in yetiştirdiği en büyük güreşçilerden biridir. 1966, 1967 ve 1968 yıllarında üst üste üç kez başpehlivan olarak altın kemerin ebedi sahibi olmuştur." 
            },
            { 
                id: 21, 
                ad: "Filiz Nurullah", 
                lakap: "Dev", 
                boy: 205, 
                kilo: 170, 
                tur: "Efsane", 
                img: "img/filiz_nurullah.jpg", 
                kariyer: "Tarihin En İri Pehlivanı",
                dogumYili: 1856, 
                uzmanlik: "Saf Güç, Muazzam Fiziksel Baskı ve Tuş Etme",
                memleket: "Burgaz, Bulgaristan", // YENİ ALAN
                bio: "Türk güreş tarihinin fiziksel olarak en iri pehlivanlarından biridir. Boyunun 2 metrenin üzerinde, kilosunun ise 170 civarında olduğu söylenir. Avrupa'da yaptığı güreşlerde rakiplerini adeta oyuncak gibi savurmasıyla ünlenmiştir." 
            },
            { 
                id: 22, 
                ad: "Cengiz Elbeye", 
                lakap: "Paşa", 
                boy: 185, 
                kilo: 110, 
                tur: "Efsane", 
                img: "img/cengiz_elbeye.jpg", 
                kariyer: "2 Kez Başpehlivan (1994, 1998)",
                dogumYili: 1969, 
                uzmanlik: "Teknik, Sakinlik ve İyi Zamanlanmış Hamleler",
                memleket: "Antalya", // YENİ ALAN
                bio: "1994 ve 1998 yılları Kırkpınar Başpehlivanıdır. Ahmet Taşçı'nın hegemonyasını kıran ender isimlerden biriydi. Çok teknik, sakin ve beyefendi kişiliğiyle tanınırdı. Ne yazık ki çok genç yaşta, 43 yaşında beyin tümörü nedeniyle vefat etmiştir." 
            },
            { 
                id: 23, 
                ad: "Hüseyin Çokal", 
                lakap: "Denizlili", 
                boy: 188, 
                kilo: 120, 
                tur: "Efsane", 
                img: "img/huseyin_cokal.jpg", 
                kariyer: "1 Ebedi Altın Kemer (1982-84)",
                dogumYili: 1954, 
                uzmanlik: "Azim, Dayanıklılık ve Geriye Dönük Oyunlar",
                memleket: "Denizli", // YENİ ALAN
                bio: "1982, 1983 ve 1984 yıllarında Kırkpınar Başpehlivanı olarak altın kemerin ebedi sahibi olmuştur. Sakatlanmasına rağmen güreşi bırakmamış ve azmiyle şampiyonluklara ulaşmıştır." 
            },
            { 
                id: 24, 
                ad: "Recep Gürbüz", 
                lakap: "Yarım Kalan Efsane", 
                boy: 195, 
                kilo: 120, 
                tur: "Efsane", 
                img: "img/recep_gurbuz.jpg", 
                kariyer: "1988 Başpehlivanı (Ali Gürbüz'ün babası)",
                dogumYili: 1963, 
                uzmanlik: "Muhteşem Fizik, Yüksek Yetenek ve Boy Avantajı",
                memleket: "Antalya", // YENİ ALAN
                bio: "Ali Gürbüz'ün babasıdır. 1988 yılında Kırkpınar Başpehlivanı olmuştur. Muhteşem bir fiziğe ve yeteneğe sahipti. Ancak 1989 yılında, henüz 26 yaşındayken beyin tümörü nedeniyle vefat etmiştir. Altın kemere doyamadan aramızdan ayrılmıştır." 
            }
        ];

        // --- 2. GENİŞLETİLMİŞ VE TERS KRONOLOJİK SIRALI TARİHÇE ---
        const TARIHCE = [
            // Günümüzden Geriye
            { yil: 2024, ad: "Yusuf Can Zeybek", sehir: "Antalya", not: "Puanlamada kazandı. Üst üste ikinci şampiyonluk." },
            { yil: 2023, ad: "Yusuf Can Zeybek", sehir: "Antalya", not: "İsmail Balaban'ı yendi. İlk başpehlivanlığı." },
            { yil: 2022, ad: "Mustafa Taş", sehir: "Sinop", not: "Cengizhan Şimşek cezalı sayıldı, kemer Mustafa Taş'a verildi." },
            { yil: 2021, ad: "Ali Gürbüz", sehir: "Antalya", not: "İsmail Koç'u yendi. Dördüncü şampiyonluk." },
            { yil: 2019, ad: "Ali Gürbüz", sehir: "Antalya", not: "Orhan Okulu'yu yendi. Geri dönüş şampiyonluğu." },
            { yil: 2018, ad: "Orhan Okulu", sehir: "Antalya", not: "Şaban Yılmaz'ı yendi." },
            { yil: 2017, ad: "İsmail Balaban", sehir: "Antalya", not: "Orhan Okulu'yu yendi." },
            { yil: 2016, ad: "Recep Kara", sehir: "Ordu", not: "Mehmet Y. Yeşil'i yendi." },
            { yil: 2015, ad: "Orhan Okulu", sehir: "Antalya", not: "Osman Aynur'u yendi." },
            { yil: 2014, ad: "Fatih Atlı", sehir: "Samsun", not: "İsmail Balaban'ı yendi." },
            { yil: 2013, ad: "İsmail Balaban", sehir: "Antalya", not: "Ali Gürbüz dopingli çıktı, kemer İsmail Balaban'a verildi." },
            { yil: 2012, ad: "Ali Gürbüz", sehir: "Antalya", not: "Recep Kara'yı yendi." },
            { yil: 2011, ad: "Ali Gürbüz", sehir: "Antalya", not: "Recep Kara'yı yendi." },
            { yil: 2010, ad: "Mehmet Yeşil Yeşil", sehir: "Antalya", not: "Ali Gürbüz'ü yendi." },
            { yil: 2009, ad: "Mehmet Yeşil Yeşil", sehir: "Antalya", not: "Recep Kara'yı yendi. Üst üste ikinci şampiyonluk." },
            { yil: 2008, ad: "Recep Kara", sehir: "Ordu", not: "Ekrem Yavuz'u yendi." },
            { yil: 2007, ad: "Recep Kara", sehir: "Ordu", not: "Hasan Tuna'yı yendi." },
            { yil: 2006, ad: "Osman Aynur", sehir: "Antalya", not: "Recep Kara'yı yendi." },
            { yil: 2005, ad: "Şaban Yılmaz", sehir: "Samsun", not: "Ekrem Yavuz'u yendi." },
            { yil: 2004, ad: "Recep Kara", sehir: "Ordu", not: "Ahmet Taşçı'yı yendi. İlk şampiyonluğu." },
            { yil: 2003, ad: "Kenan Şimşek", sehir: "Ordu", not: "Şaban Yılmaz'ı yendi." },
            { yil: 2002, ad: "Hasan Tuna", sehir: "Antalya", not: "Savaş Yıldırım'ın diskalifiyesi sonrası." },
            { yil: 2001, ad: "Vedat Ergin", sehir: "Ankara", not: "Ahmet Taşçı finali bıraktı." },
            { yil: 2000, ad: "Bedri Yaşar", sehir: "Samsun", not: "Vedat Ergin'i yendi." },
            { yil: 1999, ad: "Ahmet Taşçı", sehir: "Karamürsel", not: "Finalde Cengiz Elbeye'yi yendi." },
            { yil: 1998, ad: "Cengiz Elbeye", sehir: "Antalya", not: "Finalde Ahmet Taşçı'yı yendi." },
            { yil: 1997, ad: "Ahmet Taşçı", sehir: "Karamürsel", not: "İkinci ebedi kemerini kazanma yolunda." },
            { yil: 1996, ad: "Ahmet Taşçı", sehir: "Karamürsel", not: "-" },
            { yil: 1995, ad: "Ahmet Taşçı", sehir: "Karamürsel", not: "-" },
            { yil: 1994, ad: "Cengiz Elbeye", sehir: "Antalya", not: "Ahmet Taşçı'nın serisini durdurdu." },
            { yil: 1993, ad: "Ahmet Taşçı", sehir: "Karamürsel", not: "İlk ebedi kemerin sahibi oldu (üst üste 3 yıl)." },
            { yil: 1992, ad: "Ahmet Taşçı", sehir: "Karamürsel", not: "-" },
            { yil: 1991, ad: "Ahmet Taşçı", sehir: "Karamürsel", not: "-" },
            { yil: 1990, ad: "Ahmet Taşçı", sehir: "Karamürsel", not: "Efsane serinin başlangıcı." },
            { yil: 1988, ad: "Recep Gürbüz", sehir: "Antalya", not: "Babası, Ali Gürbüz'ün şampiyonluğu." },
            { yil: 1984, ad: "Hüseyin Çokal", sehir: "Denizli", not: "Üst üste üç kez kazanarak ebedi kemeri aldı." },
            { yil: 1978, ad: "Aydın Demir", sehir: "Karamürsel", not: "Üst üste üç kez kazanarak ebedi kemeri aldı." },
            { yil: 1968, ad: "Mustafa Bük", sehir: "Ordu", not: "Üst üste üç kez kazanarak ebedi kemeri aldı." },
            { yil: 1942, ad: "Tekirdağlı Hüseyin", sehir: "Tekirdağ", not: "8 yıllık kesintisiz şampiyonluk serisinin sonu." },
            { yil: 1898, ad: "Adalı Halil", sehir: "Edirne", not: "Kel Aliço'yu yendi, 18 yıl şampiyon kaldı." },
            { yil: 1885, ad: "Koca Yusuf", sehir: "Deliorman", not: "Cihan Pehlivanı lakabını aldı." },
            { yil: 1870, ad: "Kel Aliço", sehir: "Plevne", not: "27 yıllık efsanevi serinin zirve yılları." },
            { yil: 1362, ad: "Kurtdereli Mehmet", sehir: "Balıkesir", not: "Yağlı güreşin ilk kaydedilen galibi." },
            { yil: 1361, ad: "Ali ve Selim", sehir: "Bursa", not: "İlk güreşte yenişemeyip can verdikleri efsane başlangıç." }
        ];

        // Şehirlerin harita koordinatları (Ortalama merkez noktaları)
        const SEHIR_KOORDINATLARI = {
            "Antalya": { lat: 36.8848, lng: 30.7040 },
            "Ordu": { lat: 40.9885, lng: 37.8763 },
            "Samsun": { lat: 41.2925, lng: 36.3323 },
            "Sinop": { lat: 42.0298, lng: 35.1508 },
            "Kocaeli": { lat: 40.7656, lng: 29.9405 },
            "Edirne": { lat: 41.6732, lng: 26.5552 },
            "Tekirdağ": { lat: 40.9839, lng: 27.5135 },
            "Denizli": { lat: 37.7833, lng: 29.0910 },
            "Balıkesir": { lat: 39.6540, lng: 27.8903 },
            "Şumnu, Bulgaristan": { lat: 43.2721, lng: 26.9200 }, // Koca Yusuf
            "Plevne, Bulgaristan": { lat: 43.4072, lng: 24.6190 }, // Kel Aliço
            "Burgaz, Bulgaristan": { lat: 42.5029, lng: 27.4721 } // Filiz Nurullah
        };

        // Ek Edirne yapıları (Harita için opsiyonel)
        const EDIRNE_YAPILARI = [
            { lat: 41.693, lng: 26.555, title: "Kırkpınar Er Meydanı", desc: "Tarihi güreşlerin yapıldığı stadyum.", img: "img/er_meydani.jpg" },
            { lat: 41.678, lng: 26.559, title: "Selimiye Camii", desc: "Mimar Sinan'ın Ustalık Eseri (UNESCO).", img: "img/selimiye.jpg" },
            { lat: 41.6905, lng: 26.558, title: "Adalet Kasrı", desc: "Edirne Sarayı'ndan kalan tarihi kule.", img: "img/adalet_kasri.jpg" },
            { lat: 41.665, lng: 26.553, title: "Tunca Köprüsü", desc: "Tarihi taş köprü.", img: "img/tunca_koprusu.jpg" },
            { lat: 41.662, lng: 26.551, title: "Meriç Köprüsü", desc: "Mecidiye Köprüsü olarak da bilinir.", img: "img/meric_koprusu.jpg" },
            { lat: 41.675, lng: 26.553, title: "Eski Cami", desc: "Edirne'nin en eski anıtsal yapısı.", img: "img/eski_cami.jpg" }
        ];

        // --- SAYFA YÜKLENİNCE ---
        window.onload = function() {
            pehlivanlariBas(PEHLIVANLAR);
            tabloyuBas(TARIHCE);
            haritayiBas();
            selectleriDoldur();
            grafigiCiz(); 
            document.getElementById('aiSimulationArea').style.display = 'none'; 
        };
        
        // GÜNCEL 3. Haritayı Oluşturma
        function haritayiBas() {
            // Harita Türkiye ve Balkanlar'a odaklanacak şekilde daha geniş bir zoom ile başlar
            var map = L.map('map').setView([40.5, 29.5], 6); 
            
            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                attribution: '&copy; OpenStreetMap & CARTO',
                maxZoom: 19
            }).addTo(map);

            var goldIcon = new L.Icon({
                iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-gold.png',
                shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
                iconSize: [25, 41], iconAnchor: [12, 41], popupAnchor: [1, -34], shadowSize: [41, 41]
            });
            
            // PEHLİVANLARIN MEMLEKETLERİNİ İŞARETLE
            const memleketler = {};
            PEHLIVANLAR.forEach(p => {
                if (!memleketler[p.memleket]) {
                    memleketler[p.memleket] = [];
                }
                memleketler[p.memleket].push(p.ad);
            });

            for (const memleket in memleketler) {
                const coords = SEHIR_KOORDINATLARI[memleket];
                if (coords) {
                    const pehlivanList = memleketler[memleket].join(', ');
                    const popupContent = `
                        <div style="text-align:center; width:150px; font-weight:bold;">
                            <h4 style="color:#333; margin-bottom:5px;">${memleket}</h4>
                            <p style="font-size:0.8rem; color:#666;">
                                <i class="fas fa-user-tag"></i> Pehlivanlar:<br>
                                ${pehlivanList}
                            </p>
                        </div>`;
                    
                    L.marker([coords.lat, coords.lng], {icon: goldIcon}).addTo(map)
                        .bindPopup(popupContent);
                }
            }
            
            // Ek Edirne yapılarını da ekleyelim (Opsiyonel)
            EDIRNE_YAPILARI.forEach(n => {
                const popupContent = `
                    <div style="text-align:center; width:200px;">
                        <h4 style="color:#333; margin-bottom:5px;">${n.title}</h4>
                        <img src="img/er_meydani.jpg" style="width:100%; height:100px; object-fit:cover; border-radius:5px; margin-bottom:5px;" onerror="imgError(this)">
                        <p style="font-size:0.8rem; color:#666;">${n.desc}</p>
                    </div>`;
                
                L.marker([n.lat, n.lng], {icon: L.icon({
                    iconUrl: 'https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-blue.png',
                    shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png',
                    iconSize: [25, 41], iconAnchor: [12, 41], popupAnchor: [1, -34], shadowSize: [41, 41]
                })}).addTo(map)
                    .bindPopup(popupContent);
            });
        }


        // --- CHATBOT ENTEGRASYONU İÇİN GÜNCELLENMİŞ FONKSİYON ---
        
        /**
         * Tüm pehlivan verilerini toplayarak AI'a bir sistem talimatı hazırlar.
         */
        function prepareAllPehlivanData() {
            let dataString = "Kırkpınar Pehlivanları Veritabanı (Mümkünse bu veriyi kullan):\n";
            PEHLIVANLAR.forEach(p => {
                dataString += `- ${p.ad} (${p.lakap}, ${p.tur}, ${p.memleket}). Kariyer: ${p.kariyer}. Uzmanlık: ${p.uzmanlik}\n`;
            });
            return dataString;
        }

        /**
         * Persona ve tüm pehlivan verilerini içeren sistemi hazırlar.
         */
        function getSystemPrompt(persona, personaPehlivan) {
            const allPehlivanData = prepareAllPehlivanData();
            let instruction = "";

            switch (persona) {
                case 'kocayusuf':
                    instruction = `Sen Koca Yusuf'sun. Konuşman sert, az ve öz olsun. Dünya şampiyonu olduğunu ve gücünün tüm Türk milletinden geldiğini hissettir. Modern soruları bile eski pehlivan ağzıyla cevapla. Kendi biyografin: ${personaPehlivan.bio}`;
                    break;
                case 'assistant':
                default:
                    instruction = "Sen Tarihi Kırkpınar Yağlı Güreşleri konusunda uzman, yardımsever ve bilge bir yapay zeka asistanısın. Kullanıcıların sorularını kısa, öz ve saygılı bir Türkçe ile cevaplıyorsun.";
                    break;
            }

            // Tüm pehlivan verilerini talimata ekle
            return instruction + "\n\n" + allPehlivanData;
        }


        // --- GEMINI API FONKSİYONLARI ---

        /**
         * LLM API'yi çağırır (Exponential Backoff ile)
         */
        async function callGemini(prompt, systemInstruction = "") {
            const API_KEY = apiKey; 
            if (!API_KEY) {
                return "HATA: Gemini API Anahtarı eksik. Lütfen kodu düzenleyip anahtarınızı giriniz.";
            }

            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${API_KEY}`;
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                config: {
                    systemInstruction: { parts: [{ text: systemInstruction }] }
                }
            };

            for (let i = 0; i < 5; i++) {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        // API Hata mesajı kontrolü (Anahtar sorunu)
                        if (errorData.error && errorData.error.message.includes("API key not valid")) {
                           return "HATA: API Anahtarı Geçersiz. Lütfen Google Console veya AI Studio'dan anahtarınızı kontrol edin.";
                        }
                        // Diğer genel HTTP hataları
                        throw new Error(`HTTP Hata: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    return data.candidates?.[0]?.content?.parts?.[0]?.text || "Üzgünüm, şu an cevap üretemiyorum.";
                } catch (e) {
                    // Bağlantı hatası durumunda 5 kez dener, sonra genel hata mesajı verir.
                    if (i === 4) {
                            // Bağlantı tamamen kesikse veya genel hata varsa bu mesaj döner
                        return "Bağlantı hatası oluştu. Lütfen daha sonra tekrar deneyin veya internet bağlantınızı ve sunucunuzu kontrol edin.";
                    }
                    await new Promise(resolve => setTimeout(resolve, Math.pow(2, i) * 1000));
                }
            }
            return "Bağlantı hatası oluştu. Lütfen daha sonra tekrar deneyin.";
        }
        
        /**
         * ✨ AI Form Analizi (MODAL İÇİN YENİ ÖZELLİK)
         */
        async function analyzeForm(pehlivanId) {
            const p = PEHLIVANLAR.find(x => x.id === pehlivanId);
            const resultBox = document.getElementById('aiFormAnalysisResult');

            resultBox.innerHTML = '<i class="fas fa-spinner fa-spin" style="color:var(--gold)"></i> Yapay Zeka Pehlivanı Analiz Ediyor...';
            
            const analysisPrompt = `
                Aşağıdaki pehlivanın biyografi, lakap, kariyer ve **uzmanlık** bilgilerini kullanarak, sadece güncel form durumuna odaklanan kısa ve keskin bir analiz yap.
                1. Pehlivanın en güçlü olduğu güreş tekniğini veya fiziksel avantajını (Boy, Kilo, Kondisyon vb.) belirt.
                2. Rakibine karşı zayıf kalabileceği olası bir noktayı (yaş, yavaşlık, rakibin özel bir tekniği vb.) tahmin et.
                3. Analizi 4-5 kısa cümleyle özetle.
                
                Pehlivan: ${p.ad} (${p.lakap}), Boy: ${p.boy} cm, Kilo: ${p.kilo} kg. Uzmanlık: ${p.uzmanlik}. Kariyer Özeti: ${p.kariyer}.
                Biyografi: ${p.bio}
            `;

            const systemPrompt = "Sen bir spor yorumcusu ve analistisin. Sadece güncel performans tahminleri yap.";
            const analysis = await callGemini(analysisPrompt, systemPrompt);

            const cleanText = analysis.replace(/\*\*/g, '<strong>').replace(/\n/g, '<br>');
            resultBox.innerHTML = `<strong style="color:var(--gold)"><i class="fas fa-chart-line"></i> AI Form Analizi:</strong><br>${cleanText}`;
        }


        /**
         * ✨ AI Maç Simülasyonu
         */
        async function simulateMatch() {
            const id1 = document.getElementById("sel1").value;
            const id2 = document.getElementById("sel2").value;
            
            if (isNaN(id1) || isNaN(id2)) return;

            const p1 = PEHLIVANLAR.find(p => p.id == id1);
            const p2 = PEHLIVANLAR.find(p => p.id == id2);
            
            const resultBox = document.getElementById('aiSimulationResult');
            resultBox.style.display = 'block';
            resultBox.innerHTML = '<i class="fas fa-spinner fa-spin" style="color:var(--gold)"></i> Spiker maçı yorumluyor, lütfen bekleyin...';

            const prompt = `
                Aşağıdaki iki başpehlivan arasında geçen tarihi Kırkpınar final maçını, pehlivanların fiziksel özelliklerine, lakaplarına, biyografilerine ve **uzmanlık alanlarına** dayanarak canlı bir spiker gibi heyecanlı ve edebi bir dille anlat. 
                Kazananı pehlivanların özelliklerini karşılaştırarak mantıklı bir şekilde belirle ve senaryoyu sürprizli bir sonla bitir. Kısa bir paragraf olsun (Maksimum 120 kelime).

                Pehlivan 1: ${p1.ad} (${p1.lakap}), Boy: ${p1.boy} cm, Kilo: ${p1.kilo} kg. Uzmanlık: ${p1.uzmanlik}. Memleket: ${p1.memleket}. Biyografi Özeti: ${p1.bio}
                Pehlivan 2: ${p2.ad} (${p2.lakap}), Boy: ${p2.boy} cm, Kilo: ${p2.kilo} kg. Uzmanlık: ${p2.uzmanlik}. Memleket: ${p2.memleket}. Biyografi Özeti: ${p2.bio}
            `;

            const systemPrompt = "Sen coşkulu, şiirsel ve Kırkpınar güreş kurallarına hakim bir Cazgır/Spiker karışımı yapay zekasın. Maçı bir tiyatro oyunu gibi anlat.";
            const commentary = await callGemini(prompt, systemPrompt);

            const cleanText = commentary.replace(/\*\*/g, '<strong>').replace(/\n/g, '<br>');
            resultBox.innerHTML = `<strong style="color:var(--gold)">🎙️ Er Meydanı Canlı Yorumu:</strong><br><br>${cleanText}`;
        }
        
        /**
         * 🤖 Kırkpınar Asistanı Chatbot Fonksiyonları
         */

        function toggleChat() { 
            const box = document.getElementById('chatBox'); 
            box.style.display = box.style.display === 'flex' ? 'none' : 'flex'; 
            if (box.style.display === 'flex') {
                document.getElementById('chatInput').focus();
            }
        }

        function handleEnter(e) { 
            if (e.key === 'Enter') sendMessage(); 
        }

        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const msg = input.value.trim();
            if(!msg) return;

            const personaValue = document.getElementById('personaSelect').value;
            let personaPehlivan = null;
            
            if (personaValue === 'kocayusuf') {
                personaPehlivan = PEHLIVANLAR.find(p => p.ad === "Koca Yusuf");
            }
            
            const systemPrompt = getSystemPrompt(personaValue, personaPehlivan);
            
            const chatMessages = document.getElementById('chatMessages');
            chatMessages.innerHTML += `<div class="message user-msg">${msg}</div>`;
            input.value = '';
            chatMessages.scrollTop = chatMessages.scrollHeight;

            const loadingDiv = document.createElement('div');
            loadingDiv.className = 'message bot-msg';
            loadingDiv.innerHTML = '<i class="fas fa-ellipsis-h fa-beat"></i>'; // Yazıyor animasyonu
            chatMessages.appendChild(loadingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;

            const response = await callGemini(msg, systemPrompt);

            chatMessages.removeChild(loadingDiv);
            const formattedResponse = response.replace(/\*\*/g, '<strong>').replace(/\n/g, '<br>'); // Markdown temizliği
            chatMessages.innerHTML += `<div class="message bot-msg">${formattedResponse}</div>`;
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }


        // 1. Kartları Listeleme
        function pehlivanlariBas(data) {
            const grid = document.getElementById("pehlivanGrid");
            grid.innerHTML = "";
            data.forEach(p => {
                grid.innerHTML += `
                <div class="card" onclick="modalAc(${p.id})">
                    <span class="card-badge">${p.tur}</span>
                    <img class="card-img" src="${p.img}" alt="${p.ad}" onerror="imgError(this)">
                    <div class="card-info">
                        <h3 style="color:#fff;">${p.ad}</h3>
                        <p class="gold" style="font-size:0.9rem;">"${p.lakap}"</p>
                    </div>
                </div>`;
            });
        }

        // 2. Tabloyu Doldurma
        function tabloyuBas(data) {
            const tbody = document.querySelector("#tarihceTable tbody");
            tbody.innerHTML = "";
            
            data.sort((a, b) => b.yil - a.yil); // Günümüzden geçmişe sırala

            data.forEach(t => {
                tbody.innerHTML += `
                <tr>
                    <td><span style="background:var(--gold); color:#000; padding:2px 6px; border-radius:4px; font-weight:bold;">${t.yil}</span></td>
                    <td style="font-weight:bold; color:#fff;">${t.ad}</td>
                    <td>${t.sehir}</td>
                    <td style="font-size:0.85rem; color:#aaa;">${t.not}</td>
                </tr>`;
            });
        }

        // Kıyaslama ve yardımcı fonksiyonlar
        function selectleriDoldur() {
            const s1 = document.getElementById("sel1");
            const s2 = document.getElementById("sel2");
            PEHLIVANLAR.forEach(p => {
                let opt = `<option value="${p.id}">${p.ad}</option>`;
                s1.innerHTML += opt;
                s2.innerHTML += opt;
            });
        }
        
        function calculateBMI(boyCm, kiloKg) {
            const boyM = boyCm / 100;
            return (kiloKg / (boyM * boyM)).toFixed(2);
        }

        function kiyasla() {
            const id1 = document.getElementById("sel1").value;
            const id2 = document.getElementById("sel2").value;
            
            const aiArea = document.getElementById('aiSimulationArea');
            const resultBox = document.getElementById("compResult");

            if (id1 === "" || id2 === "" || id1 === id2) {
                 resultBox.style.display = "none";
                 aiArea.style.display = 'none';
                 return;
            }

            const p1 = PEHLIVANLAR.find(p => p.id == id1);
            const p2 = PEHLIVANLAR.find(p => p.id == id2);
            
            if (!p1 || !p2) {
                 resultBox.style.display = "none";
                 aiArea.style.display = 'none';
                 return;
            }

            const bmi1 = calculateBMI(p1.boy, p1.kilo);
            const bmi2 = calculateBMI(p2.boy, p2.kilo);

            document.getElementById("compResult").style.display = "flex";
            aiArea.style.display = 'block'; 
            document.getElementById('aiSimulationResult').innerHTML = ""; 

            document.getElementById("cImg1").src = p1.img;
            document.getElementById("cName1").innerText = p1.ad;
            document.getElementById("cTur1").innerText = p1.tur;
            document.getElementById("cBoy1").innerText = p1.boy;
            document.getElementById("cKilo1").innerText = p1.kilo;
            document.getElementById("cUzmanlik1").innerText = p1.uzmanlik;
            document.getElementById("cBMI1").innerText = bmi1;
            document.getElementById("cCareer1").innerText = p1.kariyer;

            document.getElementById("cImg2").src = p2.img;
            document.getElementById("cName2").innerText = p2.ad;
            document.getElementById("cTur2").innerText = p2.tur;
            document.getElementById("cBoy2").innerText = p2.boy;
            document.getElementById("cKilo2").innerText = p2.kilo;
            document.getElementById("cUzmanlik2").innerText = p2.uzmanlik;
            document.getElementById("cBMI2").innerText = bmi2;
            document.getElementById("cCareer2").innerText = p2.kariyer;

            highlight("cBoy1", "cBoy2", p1.boy, p2.boy, 'max'); 
            highlight("cKilo1", "cKilo2", p1.kilo, p2.kilo, 'max'); 
            highlight("cBMI1", "cBMI2", bmi1, bmi2, 'min'); 
        }
        
        function highlight(id1, id2, v1, v2, type) {
            const el1 = document.getElementById(id1);
            const el2 = document.getElementById(id2);
            
            el1.classList.remove('winner');
            el2.classList.remove('winner');
            
            if (type === 'max') {
                if (parseFloat(v1) > parseFloat(v2)) el1.classList.add('winner');
                else if (parseFloat(v2) > parseFloat(v1)) el2.classList.add('winner');
            } else if (type === 'min') {
                if (parseFloat(v1) < parseFloat(v2)) el1.classList.add('winner');
                else if (parseFloat(v2) < parseFloat(v1)) el2.classList.add('winner');
            }
        }

        function grafigiCiz() {
            const ctx = document.getElementById('combinedChartCanvas').getContext('2d');
            const grafikVerisi = PEHLIVANLAR;
            const labels = grafikVerisi.map(p => {
                const parts = p.ad.split(" ");
                if (parts.length > 1) {
                    return parts[0] + " " + parts.slice(1).map(s => s.charAt(0) + ".").join('');
                }
                return p.ad;
            });
            
            const boylar = grafikVerisi.map(p => p.boy);
            const kilolar = grafikVerisi.map(p => p.kilo);

            if (window.combinedChart) window.combinedChart.destroy();

            window.combinedChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        { 
                            label: 'Boy (cm)', 
                            data: boylar, 
                            backgroundColor: '#aa8c2c',
                            borderWidth: 1,
                            borderColor: '#000'
                        },
                        { 
                            label: 'Kilo (kg)', 
                            data: kilolar, 
                            backgroundColor: '#d4af37',
                            borderWidth: 1,
                            borderColor: '#000'
                        }
                    ]
                },
                options: {
                    indexAxis: 'y', 
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { 
                        legend: { 
                            labels: { color: '#fff' } 
                        },
                        title: {
                            display: true,
                            text: 'Boy ve Kilo Karşılaştırması',
                            color: 'white',
                            font: {
                                size: 16
                            }
                        }
                    },
                    scales: { 
                        x: { 
                            ticks: { color: '#aaa' }, 
                            grid: { color: '#333' } 
                        }, 
                        y: { 
                            ticks: { color: '#aaa', font: { size: 10 } }, 
                            grid: { display: false } 
                        } 
                    }
                }
            });
        }
        
        function modalAc(id) {
            const p = PEHLIVANLAR.find(x => x.id === id);
            currentPehlivanId = id; 
            
            document.getElementById("mImg").src = p.img;
            document.getElementById("mName").innerText = p.ad;
            document.getElementById("mLakap").innerText = `"${p.lakap}"`;
            document.getElementById("mBoy").innerText = p.boy;
            document.getElementById("mKilo").innerText = p.kilo;
            document.getElementById("mTurBadge").innerText = p.tur;
            document.getElementById("mTurBadge").style.color = p.tur === "Efsane" ? "#d4af37" : "#fff";
            document.getElementById("mBio").innerText = p.bio;
            document.getElementById("mUzmanlik").innerText = p.uzmanlik;
            
            document.getElementById("aiFormAnalysisResult").innerHTML = "AI Form Analizi için butona tıklayınız."; 

            document.getElementById("bioModal").style.display = "flex";
        }

        function filtrele() {
            const val = document.getElementById("searchInput").value.toLowerCase();
            const filtrelenen = PEHLIVANLAR.filter(p => p.ad.toLowerCase().includes(val));
            pehlivanlariBas(filtrelenen);
            
            const noRes = document.getElementById("noResult");
            if(filtrelenen.length === 0) noRes.style.display = "block";
            else noRes.style.display = "none";
        }

        function kategoriFiltre(tur) {
            if(tur === 'Tümü') {
                pehlivanlariBas(PEHLIVANLAR);
            } else {
                const filtrelenen = PEHLIVANLAR.filter(p => p.tur === tur);
                pehlivanlariBas(filtrelenen);
            }
        }

        function imgError(image) {
            image.onerror = "";
            image.src = "https://placehold.co/400x500/1a1a1a/d4af37?text=Resim+Yok";
            return true;
        }
    </script>
</body>
</html>